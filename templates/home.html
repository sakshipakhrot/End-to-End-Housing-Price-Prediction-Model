<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predict Price - Real Estate</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .section-header { border-left: 5px solid #0d6efd; padding-left: 10px; margin: 20px 0; color: #0d6efd; font-weight: bold; }
        .card { border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-radius: 15px; }
        .result-container { scroll-margin-top: 30px; border-radius: 10px; }
        .form-label { font-size: 0.9rem; font-weight: 500; color: #444; }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="card p-4 mb-4">
            <h2 class="text-center mb-4 text-primary">Property Value Estimator</h2>
            
            {% if results %}
            <div id="prediction-result" class="alert alert-success text-center mt-3 result-container">
                <h2 class="mb-0">Estimated Price: <span class="badge bg-success">${{ results }}</span></h2>
            </div>
            {% endif %}

            <form action="/predictdata" method="POST" autocomplete="off" id="predictionForm">
                
                <h4 class="section-header">Location & Time</h4>
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label">City (Full Name)</label>
                        <input type="text" name="city_full" class="form-control" placeholder="e.g., Atlanta, GA" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Zipcode</label>
                        <input type="text" name="zipcode" class="form-control" placeholder="30301" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Year</label>
                        <input type="number" name="year" class="form-control" value="2026" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Quarter (1-4)</label>
                        <input type="number" name="quarter" class="form-control" min="1" max="4" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Month (1-12)</label>
                        <input type="number" name="month" class="form-control" min="1" max="12" required>
                    </div>
                </div>

                <h4 class="section-header">Market Statistics</h4>
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Median List Price</label>
                        <input type="number" step="0.01" name="median_list_price" class="form-control" placeholder="Required for model" required>
                    </div>
                    <div class="col-md-3"><label class="form-label">Median PPSF</label><input type="number" step="0.01" name="median_ppsf" class="form-control" required></div>
                    <div class="col-md-3"><label class="form-label">Median List PPSF</label><input type="number" step="0.01" name="median_list_ppsf" class="form-control" required></div>
                    <div class="col-md-3"><label class="form-label">Homes Sold</label><input type="number" step="0.1" name="homes_sold" class="form-control" required></div>
                    <div class="col-md-3"><label class="form-label">Pending Sales</label><input type="number" step="0.1" name="pending_sales" class="form-control" required></div>
                    <div class="col-md-3"><label class="form-label">New Listings</label><input type="number" step="0.1" name="new_listings" class="form-control" required></div>
                    <div class="col-md-3"><label class="form-label">Inventory</label><input type="number" step="0.1" name="inventory" class="form-control" required></div>
                    <div class="col-md-3">
                        <label class="form-label">Median DOM</label>
                        <input type="number" step="0.1" name="median_dom" class="form-control" required>
                    </div>
                    <div class="col-md-3"><label class="form-label">Avg Sale/List Ratio</label><input type="number" step="0.01" name="avg_sale_to_list" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Sold Above List (%)</label><input type="number" step="0.01" name="sold_above_list" class="form-control" required></div>
                    <div class="col-md-5"><label class="form-label">Off Market in 2 Weeks (%)</label><input type="number" step="0.01" name="off_market_in_two_weeks" class="form-control" required></div>
                </div>

                <h4 class="section-header">Nearby Amenities (Count)</h4>
                <div class="row g-2">
                    {% for item in ['bank', 'bus', 'hospital', 'mall', 'park', 'restaurant', 'school', 'station', 'supermarket'] %}
                    <div class="col-md-4">
                        <div class="input-group mb-2">
                            <span class="input-group-text w-50" style="font-size: 0.8rem;">{{ item.capitalize() }}</span>
                            <input type="number" name="{{ item }}" class="form-control" value="0" step="1">
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <h4 class="section-header">Regional Demographics</h4>
                <div class="row g-3">
                    <div class="col-md-4"><label class="form-label">Total Population</label><input type="number" step="0.1" name="total_population" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Median Age</label><input type="number" step="0.1" name="median_age" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Per Capita Income</label><input type="number" step="0.1" name="per_capita_income" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Families Below Poverty</label><input type="number" step="0.1" name="families_below_poverty" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Total Housing Units</label><input type="number" step="0.1" name="housing_units" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Median Rent</label><input type="number" step="0.1" name="median_rent" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Median Home Value</label><input type="number" step="0.1" name="median_home_value" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Total Labor Force</label><input type="number" step="0.1" name="labor_force" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Unemployed Population</label><input type="number" step="0.1" name="unemployed" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">School Age Pop</label><input type="number" step="0.1" name="school_age_pop" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">School Enrollment</label><input type="number" step="0.1" name="school_enrollment" class="form-control" required></div>
                    <div class="col-md-4"><label class="form-label">Median Commute Time</label><input type="number" step="0.1" name="commute_time" class="form-control" required></div>
                </div>

                <div class="text-center mt-5">
                    <button type="submit" class="btn btn-primary btn-lg px-5 shadow-sm" id="submitBtn">Predict Market Price</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Prevent cursor jumping and handle result scrolling
        window.onload = function() {
            const resultBox = document.getElementById('prediction-result');
            if (resultBox) {
                resultBox.scrollIntoView({ behavior: 'smooth' });
            }
            if (document.activeElement) {
                document.activeElement.blur();
            }
        };

        // Ensure the form doesn't keep focus on button after clicking
        document.getElementById('predictionForm').addEventListener('submit', function() {
            if (document.activeElement) {
                document.activeElement.blur();
            }
        });
    </script>
</body>
</html>